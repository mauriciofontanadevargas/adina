version: "3.1"

intents:
  - greet
  - goodbye
  - affirm
  - deny
  - need_physical_intervention
  - need_medication_help
  - mood_great
  - mood_unhappy
  - mood_neutral
  - feeling_pain
  - talk_about_weather
  - bot_challenge
  - inform_issue_fatigue
  - inform_issue_heart
  - inform_issue_mental
  - inform_issue_mobility
  - inform_issue_gastro
  - inform_pain_level_low
  - inform_pain_level_medium
  - inform_pain_level_high
  - inform_took_medication

entities:
  - issue_frequency
  - issue_level

responses:
  utter_iamabot:
    - text: "I'm not a human. I am a robot"
  utter_greet:
    - text: "Hello. How have you been?"
    - text: "How are you doing today?"
    - text: "Hi! How's your day been?"
    - text: "Hey, how is it going?"
    - text: "Hey! How are you?"
  utter_goodbye:
    - text: "See you next time"
  utter_proceed_questionnaire:
    - text: "I have a few questions to ask you. It won't take long."
    - text: "Now I will ask you a few things."
  utter_recall_and_ask_last_issue:
    - text: "By the way, how's the {previous_issue} you told me before? Do you feel better?"
    - text: "I remember you told me you were not feeling so well because of the {previous_issue}. How do you feel now?"
  utter_glad_better:
    - text: "I'm glad you are better now"
    - text: "I'm glad you are feeling better"
  utter_neutral:
    - text: "Hmmm, I'm sorry to hear that... keep taking your medication and you should be fine by tomorrow"
    - text: "That's too bad. Keep taking care of it like we told you and soon you'll be better."
  utter_got_worse_ask_more:
    - text: "That's unfortunate, I'm sorry. I'll ask you a few more questions about your issue, ok?"
    #the following utterances were generated by chatgpt/ gpt3 playground using the example sentence above
    - text: "That's too bad. Let me try to help by asking a few more questions."
    - text: "My apologies. Can I ask you a few more questions to better understand the issue?"
    - text: "Sorry to hear that. Can I ask for some more details so I can assist you better?"
    - text: "I'm sorry for the inconvenience. May I inquire about the issue a bit further?"
    - text: "Pardon the situation. Can I ask you a couple of more questions regarding the problem?"
  utter_ask_took_medication: #important: rasa user the patter utter_ask_ to link forms with its utterances
    - text: "Regarding the {last_issue}; did you take the medication recommended?"
  utter_ask_issue_level_was_informed:
    - text: "How much pain are you feeling? Some or a lot?"
  utter_ask_more_info:
    - text: "Any other detail I should know?"
  utter_ask_describe_whats_happening:
    - text: "Can you describe what's happening in general?"
  utter_ask_previous_issue:
    - text: "seraaaa? oq ta sentindo entao?"
  utter_gimme_last_issue:
    - text: "I cant remember what you had yesterday. tell me"
  utter_call_nurse:
    - text: "I understand your pain is severe. I'll ask the nurse to come see you"
  utter_chitchat:
    - text: "So you wanna chit chat, eh?"

slots:
  previous_issue:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text

  took_medication:
    type: bool
    influence_conversation: true
    mappings:
    - type: from_intent
      intent: inform_took_medication
      value: true #this value is assigned to took_medication if the intent inform_took_medication is activated & conditions are met
      conditions:
      - active_loop: previous_issue_form
        requested_slot: took_medication

  pain_level_high:
    type: bool
    influence_conversation: true
    mappings:
    - type: from_intent
      intent: inform_pain_level_high
      value: true
    - type: from_intent
      intent: affirm
      value: true
      conditions:
        - active_loop: previous_issue_form

  pain_level_medium:
    type: bool
    influence_conversation: false
    mappings:
    - type: from_intent
      intent: inform_pain_level_medium
      value: true
      conditions:
      - active_loop: previous_issue_form

  pain_level_low:
    type: bool
    influence_conversation: false
    mappings:
      - type: from_intent
        intent: inform_pain_level_low
        value: true
        conditions:
        - active_loop: previous_issue_form

# currently rasa does not support a list of intents, so we need to define multiple mappings (i.e, more boilerplate code)
  issue_level_was_informed:
    type: bool
    influence_conversation: true
    mappings:
      - type: from_intent
        intent: inform_pain_level_low
        value: true #this value is assigned to took_medication if the intent inform_took_medication is activated & conditions are met
        conditions:
        - active_loop: previous_issue_form
      - type: from_intent
        intent: inform_pain_level_medium
        value: true #this value is assigned to took_medication if the intent inform_took_medication is activated & conditions are met
        conditions:
        - active_loop: previous_issue_form
      - type: from_intent
        intent: inform_pain_level_high
        value: true #this value is assigned to took_medication if the intent inform_took_medication is activated & conditions are met
        conditions:
        - active_loop: previous_issue_form
      - type: from_entity
        entity: issue_level
        value: true #this value is assigned to took_medication if the intent inform_took_medication is activated & conditions are met
        conditions:
        - active_loop: previous_issue_form

  issue_level:
    type: categorical #categorical allows the agent to behave differently according to the user responser
    values: #only literal values are possible here, i.e., theres no way to use the nlu to map other semantically similar sentences
      - some
      - a lot
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: issue_level

  # extra variable
  issue_frequency:
    type: categorical #categorical allows the agent to behave differently according to the user responser
    values: #only literal values are possible here, i.e., theres no way to use the nlu to map other semantically similar sentences
      - sometimes
      - often
      - frequent
      - constant
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: issue_frequency

  more_info:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text

forms:
  previous_issue_form:
    required_slots:
      - took_medication
      - issue_level_was_informed
      - more_info



session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
